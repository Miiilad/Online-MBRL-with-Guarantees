import numpy as np


class ADP:
    def __init__(self, env_name) -> None:
        if env_name == "Pendulum":
            self.select_control = self.controller_pendulum
        else:
            self.select_control = self.controller_cartpole

    def controller_pendulum(self,state):
        x1 = state[0]
        x2 = state[1]
        out = (7795597201741591*x1**2*x2)/288230376151711744 - (6018296215689919*x2)/9007199254740992 - (2388820821708893*np.sin(x1))/2251799813685248 - (8898707384869323*np.sin(x2))/2305843009213693952 - (4841914565118961*x1*x2**2)/144115188075855872 - (2675935673177633*x1)/9007199254740992 - (5008161985231293*x1**3)/144115188075855872 - (4992954021382931*x2**3)/576460752303423488
        return np.array([out]).clip(-5.0,5.0)

    def controller_cartpole(self,state):
        x1 = state[0]
        x2 = state[1]
        x3 = state[2]
        x4 = state[3]
        out = (3881519485203603*x1**3)/70368744177664 + (5083830123477335*x1**2*x2)/140737488355328 + (4580765970833937*x1**2*x3)/70368744177664 + (7270618314905949*x1**2*x4)/140737488355328 + (4150092189877365*x1*x2**2)/281474976710656 + (2623724328250121*x1*x2*x3)/70368744177664 + (4314975973886189*x1*x2*x4)/140737488355328 + (7047779699717561*x1*x3**2)/281474976710656 + (3935121520933973*x1*x3*x4)/70368744177664 + (2111174205318659*x1*x4**2)/140737488355328 + (801109006537997*x1)/8796093022208 + (1265005631995821*x2**3)/1125899906842624 + (2035610170438077*x2**2*x3)/281474976710656 + (4862230691283523*x2**2*x4)/2251799813685248 + (3231245056131005*x2*x3**2)/562949953421312 + (7419331640281517*x2*x3*x4)/562949953421312 + (3192625428123671*x2*x4**2)/4503599627370496 + (7221019849595695*x2)/281474976710656 + (613618914275327*x3**3)/140737488355328 + (1947706819656451*x3**2*x4)/140737488355328 + (4733070777864267*x3*x4**2)/1125899906842624 + (3832678942049911*x3)/281474976710656 - (1258432896972643*x4**3)/4503599627370496 + (575112551141401*x4)/35184372088832
        return np.array([out]).clip(-5.0,5.0)
    