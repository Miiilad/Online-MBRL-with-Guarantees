import numpy as np


class SGA:
    def __init__(self, env_name) -> None:
        if env_name == "Pendulum":
            self.select_control = self.controller_pendulum
        else:
            self.select_control = self.controller_cartpole

    def controller_pendulum(self,state):
        x1 = state[0]
        x2 = state[1]
        out = 0.0039541535946505810372457229070517*x1**7 + 0.023934033312917678018917636230979*x1**6*x2 - 0.013420841078404050390399576922044*x1**5*x2**2 - 0.039081939065659018492367743297007*x1**5 + 0.00715047209793374583884965762279*x1**4*x2**3 - 0.10507119430738162400251877957345*x1**4*x2 - 0.0026690813437509330643755085260903*x1**3*x2**4 + 0.044580364073293041183306970161815*x1**3*x2**2 + 0.20480374192336243181006126773076*x1**3 - 0.000011815162802197059819901820656189*x1**2*x2**5 - 0.011756817584190151149507002930353*x1**2*x2**3 + 0.10972285976586722724561741309745*x1**2*x2 + 0.0004266382133576934839225995245929*x1*x2**6 - 0.000014232842952900439774144026487457*x1*x2**4 - 0.019083817950733310463765134242738*x1*x2**2 - 1.4093200421527041543522152877568*x1 - 0.00063355762529009339883913943487241*x2**7 + 0.0054198680437141014707869703921801*x2**5 - 0.013814973702503506191603327531748*x2**3 - 0.65416107722607981536794563270949*x2
        return np.array([out]).clip(-5.0,5.0)

    def controller_cartpole(self,state):
        x1 = state[0]
        x2 = state[1]
        x3 = state[2]
        x4 = state[3]
        out = - (4531.5031193346684810598146868802*x1**3 + 1381.9063402954298885598560430335*x1**2*x2 + 6049.0730059994992064065723717345*x1**2*x3 + 2078.7986370689110229663340409182*x1**2*x4 - 384.74642294950828348589825184158*x1*x2**2 + 196.15248913666493789017263729795*x1*x2*x3 - 954.6654375087643301738802640919*x1*x2*x4 + 3011.8935380146397229753866144925*x1*x3**2 + 317.47582398543398027857379359132*x1*x3*x4 - 676.87226931546275841020176853929*x1*x4**2 + 128.92350683829799557721614069381*x1 - 109.86106455378387789876342598085*x2**3 - 458.51946306387208458467764540462*x2**2*x3 - 426.52580262291485177887530640408*x2**2*x4 - 39.857976382575617593738581899117*x2*x3**2 - 1058.2551090673173634978919255817*x2*x3*x4 - 545.31379579382524158638921646846*x2*x4**2 + 38.646528068249422885312779549292*x2 + 570.48894687145932446428938108075*x3**3 + 92.884436164038322921063473876113*x3**2*x4 - 581.93466278061032906276375015294*x3*x4**2 + 103.94551101138249255743259853642*x3 - 220.79095385734744159497765016613*x4**3 + 72.631697729837749332264896396587*x4)/(2*(np.sin(x1)**2/10 + 1)) - (5*np.cos(x1)*(- 2857.4619337990330797780728291378*x1**3 - 745.62539233568619261161426635324*x1**2*x2 - 3966.815582205700645169702451381*x1**2*x3 - 1381.9063402954298885598560430335*x1**2*x4 + 326.88466321871946434829169790603*x1*x2**2 + 108.74688603766432396513491776254*x1*x2*x3 + 769.49284589901656697179650368316*x1*x2*x4 - 2113.2444167826297475427568714639*x1*x3**2 - 196.15248913666493789017263729795*x1*x3*x4 + 477.33271875438216508694013204595*x1*x4**2 - 59.385911510117136682339746622194*x1 + 83.173439589166144715110064071141*x2**3 + 390.72122659740721246879738901856*x2**2*x3 + 329.58319366135163369629027794255*x2**2*x4 + 210.740980124600306969740383227*x2*x3**2 + 917.03892612774416916935529080924*x2*x3*x4 + 426.52580262291485177887530640408*x2*x4**2 - 18.354263434311556760550351895591*x2 - 453.55175282104714170092184597265*x3**3 + 39.857976382575617593738581899117*x3**2*x4 + 529.12755453365868174894596279085*x3*x4**2 - 61.71326973897689109811603392202*x3 + 181.77126526460841386212973882282*x4**3 - 38.646528068249422885312779549292*x4))/(8*(np.sin(x1)**2/10 + 1))
        return np.array([out]).clip(-5.0,5.0)
    